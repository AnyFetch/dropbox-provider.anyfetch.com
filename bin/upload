#!/bin/env node

'use strict';
/**
 * @file Regularly upload datas from all tokens to Cluestr
 *
 * This script relaunches itself.
 */
 
var REFRESH_TIME = 60 * 60 * 1000;

require('../app.js');
var providerDropbox = require('../lib/provider-dropbox');

function cb(err) {
  if(err) {
    console.err(err);
  } else {
    console.log("Dropbox files logged", new Date());
  }

  var uploader = function() {
    providerDropbox.helpers.upload(cb);
  };

  setTimeout(uploader, REFRESH_TIME);
}

console.log("Starting Dropbox pseudo-daemon.");

// First run
providerDropbox.helpers.upload(cb);
